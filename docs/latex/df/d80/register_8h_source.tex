\hypertarget{register_8h_source}{}\doxysection{register.\+h}
\label{register_8h_source}\index{src/furniture/register.h@{src/furniture/register.h}}
\mbox{\hyperlink{register_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}../external\_include.h"{}}}
\DoxyCodeLine{00005\ \textcolor{comment}{//}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}../engine/assert.h"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}../entity.h"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}../globals.h"{}}}
\DoxyCodeLine{00009\ \textcolor{comment}{//}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}../aiperson.h"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}../furniture.h"{}}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}../targetcube.h"{}}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_register_next_queue_position}{RegisterNextQueuePosition}}\ :\ \mbox{\hyperlink{struct_target_cube}{TargetCube}}\ \{}
\DoxyCodeLine{00015\ \ \ \ \ \mbox{\hyperlink{struct_register_next_queue_position_a3ddbe1e3dbc639fa4762aa260d730db5}{RegisterNextQueuePosition}}(\mbox{\hyperlink{graphics_8h_a308f9233b868e4e52062de502c3d9cef}{vec3}}\ p,\ Color\ face\_color\_in,\ Color\ base\_color\_in)}
\DoxyCodeLine{00016\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{struct_target_cube}{TargetCube}}(p,\ face\_color\_in,\ base\_color\_in)\ \{\}}
\DoxyCodeLine{00017\ \ \ \ \ \mbox{\hyperlink{struct_register_next_queue_position_a453370798e70814587b1316edaded850}{RegisterNextQueuePosition}}(\mbox{\hyperlink{graphics_8h_acf64f2c7361f0fc6883a80cb1d698f28}{vec2}}\ p,\ Color\ face\_color\_in,\ Color\ base\_color\_in)}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{struct_target_cube}{TargetCube}}(p,\ face\_color\_in,\ base\_color\_in)\ \{\}}
\DoxyCodeLine{00019\ \ \ \ \ \mbox{\hyperlink{struct_register_next_queue_position_aeb5278282ff279ce1863ebe857484af2}{RegisterNextQueuePosition}}(\mbox{\hyperlink{graphics_8h_a308f9233b868e4e52062de502c3d9cef}{vec3}}\ p,\ Color\ c)\ :\ \mbox{\hyperlink{struct_target_cube}{TargetCube}}(p,\ c)\ \{\}}
\DoxyCodeLine{00020\ \ \ \ \ \mbox{\hyperlink{struct_register_next_queue_position_a013bb63b8b90de46bab3d8e7a3c90b97}{RegisterNextQueuePosition}}(\mbox{\hyperlink{graphics_8h_acf64f2c7361f0fc6883a80cb1d698f28}{vec2}}\ p,\ Color\ c)\ :\ \mbox{\hyperlink{struct_target_cube}{TargetCube}}(p,\ c)\ \{\}}
\DoxyCodeLine{00021\ \};}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_register}{Register}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{struct_furniture}{Furniture}}\ \{}
\DoxyCodeLine{00024\ \ \ \ \ std::deque<AIPerson*>\ \mbox{\hyperlink{struct_register_aaa92e3005c08cbf6cd11a3620b7339b9}{ppl\_in\_line}};}
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{struct_register_acf7d318a1555dd41124082c19bfdcb0b}{max\_queue\_size}}\ =\ 3;}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{struct_register_ab2df0027c3bcd21e0e9356f79b014482}{next\_line\_position}}\ =\ 0;}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{keyword}{friend}\ bitsery::Access;}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ S>}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{struct_register_a18bde4ae5c701253e65d7be145c38648}{serialize}}(S\&\ s)\ \{}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ s.ext(*\textcolor{keyword}{this},\ bitsery::ext::BaseClass<Furniture>\{\});}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ need\ to\ serialize\ things\ that\ are\ needed\ for\ render}}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ s.value4b(max\_queue\_size);}}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ s.value4b(next\_line\_position);}}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ s.container(ppl\_in\_line,\ max\_queue\_size);}}
\DoxyCodeLine{00037\ \ \ \ \ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{struct_register_a669b96861697fb8c04bce79f04390c66}{Register}}()\ :\ \mbox{\hyperlink{struct_furniture}{Furniture}}()\ \{\}}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{struct_register_a836763a1ab3ebd6cc3383cc972943db1}{Register}}(\mbox{\hyperlink{graphics_8h_acf64f2c7361f0fc6883a80cb1d698f28}{vec2}}\ pos)}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{struct_furniture}{Furniture}}(pos,\ \mbox{\hyperlink{namespaceui}{ui}}::color::grey,\ \mbox{\hyperlink{namespaceui}{ui}}::color::grey)\ \{}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_register_a2306726654fefe617d10d36bfdff8749}{update\_model}}();}
\DoxyCodeLine{00044\ \ \ \ \ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{struct_register_a2306726654fefe617d10d36bfdff8749}{update\_model}}()\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO\ add\ a\ component\ for\ this}}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ get<ModelRenderer>().update(\mbox{\hyperlink{struct_model_info}{ModelInfo}}\{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ .\mbox{\hyperlink{struct_model_info_a8ff627546f47e5e1ecef2aa93a5fe560}{model\_name}}\ =\ \textcolor{stringliteral}{"{}register"{}},}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ .size\_scale\ =\ 10.f,}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ .position\_offset\ =\ \mbox{\hyperlink{graphics_8h_a308f9233b868e4e52062de502c3d9cef}{vec3}}\{0,\ -\/\mbox{\hyperlink{globals_8h_af3c09b249c48587aba215cce49091fa0}{TILESIZE}}\ /\ 2.f,\ 0\},}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00053\ \ \ \ \ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{struct_register_a52675c14bbf0f4a3d02035c16ee0546f}{position\_in\_line}}(\mbox{\hyperlink{struct_a_i_person}{AIPerson}}*\ entity)\ \{}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ (int)\ \mbox{\hyperlink{struct_register_aaa92e3005c08cbf6cd11a3620b7339b9}{ppl\_in\_line}}.size();\ i++)\ \{}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (entity-\/>\mbox{\hyperlink{struct_entity_aa4425a59c337b4d3b71c217ccaf511bc}{id}}\ ==\ \mbox{\hyperlink{struct_register_aaa92e3005c08cbf6cd11a3620b7339b9}{ppl\_in\_line}}[i]-\/>id)\ \textcolor{keywordflow}{return}\ i;}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{log_8h_a04af09851c431d178f16b24fa1aac1e9}{log\_warn}}(\textcolor{stringliteral}{"{}Cannot\ find\ entity\ \{\}"{}},\ entity-\/>\mbox{\hyperlink{struct_entity_aa4425a59c337b4d3b71c217ccaf511bc}{id}});}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00061\ \ \ \ \ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{struct_register_ac6e47c902ad42f108f2a2aef41c16026}{can\_move\_up}}(\mbox{\hyperlink{struct_a_i_person}{AIPerson}}*\ entity)\ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ entity-\/>\mbox{\hyperlink{struct_entity_aa4425a59c337b4d3b71c217ccaf511bc}{id}}\ ==\ \mbox{\hyperlink{struct_register_aaa92e3005c08cbf6cd11a3620b7339b9}{ppl\_in\_line}}.front()-\/>id;}
\DoxyCodeLine{00065\ \ \ \ \ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{struct_register_a81d82daec8200089b62c1a97288c7938}{leave\_line}}(\mbox{\hyperlink{struct_a_i_person}{AIPerson}}*\ entity)\ \{}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ pos\ =\ this-\/>\mbox{\hyperlink{struct_register_a52675c14bbf0f4a3d02035c16ee0546f}{position\_in\_line}}(entity);}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pos\ ==\ -\/1)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pos\ ==\ 0)\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_register_aaa92e3005c08cbf6cd11a3620b7339b9}{ppl\_in\_line}}.pop\_front();}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_register_aaa92e3005c08cbf6cd11a3620b7339b9}{ppl\_in\_line}}.erase(\mbox{\hyperlink{struct_register_aaa92e3005c08cbf6cd11a3620b7339b9}{ppl\_in\_line}}.begin()\ +\ pos);}
\DoxyCodeLine{00075\ \ \ \ \ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{struct_register_a45ae07a467402f2504f9105fe0f00a47}{is\_in\_line}}(\mbox{\hyperlink{struct_a_i_person}{AIPerson}}*\ entity)\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_register_a52675c14bbf0f4a3d02035c16ee0546f}{position\_in\_line}}(entity)\ !=\ -\/1;\ \}}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{struct_register_a5a6397f692a798de835cbdad9cc3f402}{has\_space\_in\_queue}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_register_ab2df0027c3bcd21e0e9356f79b014482}{next\_line\_position}}\ <\ \mbox{\hyperlink{struct_register_acf7d318a1555dd41124082c19bfdcb0b}{max\_queue\_size}};\ \}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ \mbox{\hyperlink{graphics_8h_acf64f2c7361f0fc6883a80cb1d698f28}{vec2}}\ \mbox{\hyperlink{struct_register_a674bdeb8aa6413236b266f45d2973b57}{get\_next\_queue\_position}}(\mbox{\hyperlink{struct_a_i_person}{AIPerson}}*\ entity)\ \{}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{assert_8h_a8e93b0cbf5fbae9c583903d9f31ef315}{M\_ASSERT}}(entity,\ \textcolor{stringliteral}{"{}entity\ passed\ to\ register\ queue\ should\ not\ be\ null"{}});}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_register_aaa92e3005c08cbf6cd11a3620b7339b9}{ppl\_in\_line}}.push\_back(entity);}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ place\ the\ customers\ stand\ is\ 1\ tile\ infront\ of\ the\ register}}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ front\ =\ this-\/>\mbox{\hyperlink{struct_entity_a5ccbde35c86805a9450faa4da52f414d}{tile\_infront}}((next\_line\_position\ +\ 1)\ *\ 2);}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_register_ab2df0027c3bcd21e0e9356f79b014482}{next\_line\_position}}++;}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ front;}
\DoxyCodeLine{00087\ \ \ \ \ \}}
\DoxyCodeLine{00088\ \};}

\end{DoxyCode}
